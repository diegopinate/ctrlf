<html>
<head>
<script>
		var callbackResponse = (document.URL).split("#")[1];
		var responseParameters = (callbackResponse).split("&");
		var parameterMap = [];
		for(var i = 0; i < responseParameters.length; i++) {
			parameterMap[responseParameters[i].split("=")[0]] = responseParameters[i].split("=")[1];
		}
		if(parameterMap.access_token !== undefined && parameterMap.access_token !== null) {
			var google = {
				oauth: {
					access_token: parameterMap.access_token,
					expires_in: parameterMap.expires_in,
					account_username: parameterMap.account_username
				}
			};
			console.log("Aqui")
			window.localStorage.setItem("google", JSON.stringify(google));
			window.location.href = "http://localhost/Ctrl-F/ctrlf/src/main.html";
		} else {
			alert("Problem authenticating");
		}
	
		// First, parse the query string

/*		
var params = {}, queryString = location.hash.substring(1),
    regex = /([^&=]+)=([^&]*)/g, m;
while (m = regex.exec(queryString)) {
  params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
}

// Verify that the nonce in the response is the same as the one you sent in the
// request.
if (params['nonce'] !== nonce) {
  alert('Invalid nonce.')
} else {
  // And send the token over to the server
  var req = new XMLHttpRequest();
  // consider using POST so query isn't logged
  req.open('GET', 'https://' + window.location.host + '/catchtoken?' + queryString, true);
  req.onreadystatechange = function (e) {
    if (req.readyState == 4) {
      if (req.status == 200) {
        window.location = params['state']
      } else if (req.status == 400) {
        alert('There was an error processing the token.')
      } else {
        alert('something else other than 200 was returned')
      }
    }
  };
  req.send(null);
}
*/
</script>
</head>
<body></body>
</html>
